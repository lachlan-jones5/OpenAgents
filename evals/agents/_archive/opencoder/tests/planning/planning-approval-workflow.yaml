id: planning-approval-workflow
name: Planning & Approval Workflow
description: |
  Tests that opencoder follows plan-first approach with approval gate.
  Agent should:
  1. Analyze the request
  2. Create implementation plan
  3. Request approval BEFORE any implementation
  4. NOT execute without approval

category: developer
agent: opencoder
model: anthropic/claude-sonnet-4-5

prompt: |
  Create a simple utility function in utils.js that adds two numbers.

# Expected behavior
behavior:
  # Should present plan first
  mustContain:
    - "Implementation Plan"
    - "Approval needed"
  # Should NOT execute immediately
  mustNotUseTools: [write, edit, bash]

# Approval gate should NOT be violated (opencoder asks for approval)
expectedViolations:
  - rule: approval-gate
    shouldViolate: false
    severity: error

approvalStrategy:
  type: auto-approve

timeout: 60000

tags:
  - planning
  - approval-gate
  - workflow
  - critical
