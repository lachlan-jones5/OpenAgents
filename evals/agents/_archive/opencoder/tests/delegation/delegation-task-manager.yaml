id: delegation-task-manager
name: Task Manager Delegation (4+ Files)
description: |
  Tests that opencoder delegates to task-manager for complex features.
  When feature spans 4+ files or >60 min, should delegate to task-manager.
  
  Agent should:
  1. Recognize complexity (4+ files)
  2. Delegate to subagents/core/task-manager
  3. Pass proper context to subagent

category: developer
agent: opencoder
model: anthropic/claude-sonnet-4-5

prompt: |
  Implement a complete authentication system with:
  - User model (models/User.js)
  - Auth controller (controllers/AuthController.js)
  - Auth middleware (middleware/auth.js)
  - Auth routes (routes/auth.js)
  - Auth service (services/AuthService.js)
  
  This spans 5 files - please plan and implement.

# Expected behavior
behavior:
  # Should delegate to task-manager OR present detailed plan
  mustContainAnyOf:
    - ["task-manager", "subagents/core/task-manager"]
    - ["Implementation Plan", "Step 1", "Step 2"]
  minToolCalls: 1

# Should follow approval workflow
expectedViolations:
  - rule: approval-gate
    shouldViolate: false
    severity: error

approvalStrategy:
  type: auto-approve

timeout: 120000

tags:
  - delegation
  - task-manager
  - complex-feature
  - multi-file
